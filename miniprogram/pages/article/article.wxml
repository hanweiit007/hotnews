<view class="container">
  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">加载中...</text>
  </view>

  <!-- 错误状态 -->
  <view wx:elif="{{error}}" class="error-container">
    <view class="error-icon">⚠️</view>
    <text class="error-title">内容加载失败</text>
    <text class="error-message">抱歉，暂时无法获取文章内容</text>
    <view class="error-tips">
      <text>• 检查网络连接是否正常</text>
      <text>• 可以尝试重新加载</text>
      <text>• 或复制链接到浏览器查看</text>
    </view>
    <view class="error-actions">
      <button class="retry-btn" bindtap="reload">重新加载</button>
      <button class="copy-btn" bindtap="copyLink">复制链接</button>
    </view>
  </view>

  <!-- Webview模式 -->
  <view wx:elif="{{showWebview}}" class="webview-container">
    <!-- 显示模式标识 -->
    <view class="mode-indicator">
      <text class="mode-text">代理模式</text>
    </view>
    
    <!-- 代理内容显示 -->
    <view wx:if="{{showProxyContent}}" class="proxy-content-modal">
      <view class="proxy-content-header">
        <text>代理网页内容</text>
        <button size="mini" bindtap="closeProxyContent">关闭</button>
      </view>
      <scroll-view scroll-y class="proxy-content-body">
        <rich-text nodes="{{proxyHtmlContent}}" class="rich-text"></rich-text>
      </scroll-view>
    </view>
    
    <!-- webview组件（隐藏的备用） -->
    <web-view 
      src="{{proxyUrl}}" 
      class="webview" 
      bindload="onWebviewLoad"
      binderror="onWebviewError"
      bindmessage="onWebviewMessage"
      style="display: none;"
    ></web-view>
  </view>

  <!-- Rich-text模式 -->
  <view wx:else class="article-container">
    <!-- 文章标题 -->
    <view class="article-header">
      <text class="article-title">{{title}}</text>
      <view class="article-actions">
        <button class="action-btn" bindtap="copyLink">复制链接</button>
      </view>
    </view>

    <!-- 平台跳转按钮 -->
    <view wx:if="{{platformInfo && platformInfo.canJump}}" class="platform-jump">
      <view class="platform-info-bar">
        <text class="platform-icon">{{platformInfo.icon}}</text>
        <text class="platform-name">{{platformInfo.name}}</text>
        <text class="platform-desc">支持App直接打开</text>
      </view>
      <button class="jump-btn" style="background-color: {{platformInfo.color}}" bindtap="jumpToPlatform">
        {{platformInfo.jumpText}}
      </button>
    </view>

    <!-- 文章内容 -->
    <view class="article-content">
      <rich-text wx:if="{{content}}" nodes="{{content}}" class="rich-text"></rich-text>
      <view wx:else class="no-content">
        <text>内容加载中...</text>
      </view>
    </view>

    <!-- 底部提示 -->
    <view class="article-footer">
      <text class="footer-text">内容来源于原始链接</text>
    </view>
  </view>
</view>
